<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ödeme - Üreten Eller</title>
  <style>
    :root{
      --bg: #0b1220;
      --card: #0f172a;         /* slate-900 */
      --muted: #94a3b8;        /* slate-400 */
      --text: #e5e7eb;         /* slate-200 */
      --ring: rgba(255,255,255,.08);
      --shadow: 0 24px 60px rgba(0,0,0,.45);
      --gold-1:#f7e7b5; --gold-2:#e8c972; --gold-3:#d7b45d; --gold-4:#caa552; --gold-5:#b79343;
      --radius: 18px;
    }

    /* Sayfa arkaplanı — hafif degrade + noise hissi */
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 70% -10%, #1f2937 0%, transparent 60%),
        radial-gradient(900px 500px at -10% 110%, #111827 0%, transparent 60%),
        linear-gradient(180deg, #0a0f1a 0%, #0b1220 100%);
      display:grid;
      place-items:center;
      padding: clamp(16px, 2.5vw, 32px);
    }

    /* Ana kapsayıcı */
    .shell{
      width:min(980px, 100%);
      display:grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }

    /* Başlık şeridi */
    .brandbar{
      display:flex; align-items:center; gap:12px;
      padding: 14px 16px;
      border-radius: calc(var(--radius) - 8px);
      background: linear-gradient(135deg, rgba(255,255,255,.07), rgba(255,255,255,.02));
      border: 1px solid var(--ring);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
      backdrop-filter: blur(6px);
    }
    .brandmark{
      flex:0 0 auto; width:40px; height:40px; border-radius:12px;
      background: linear-gradient(135deg, var(--gold-1), var(--gold-3) 45%, var(--gold-5));
      box-shadow: 0 6px 18px rgba(202,165,82,.35), inset 0 1px 0 rgba(255,255,255,.65);
      display:grid; place-items:center; color:#111; font-weight:900;
      letter-spacing:.3px;
    }
    .brandtext h1{
      margin:0; font-size: clamp(18px, 2.4vw, 22px); line-height:1.2; font-weight:900;
    }
    .brandtext p{
      margin:2px 0 0; color: var(--muted); font-size: 13.5px;
    }

    /* Kart */
    .card{
      background: linear-gradient(180deg, rgba(15,23,42,.92), rgba(15,23,42,.86));
      border: 1px solid var(--ring);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .card-head{
      padding: 18px 20px;
      background:
        linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
        linear-gradient(135deg, var(--gold-1), var(--gold-2) 40%, var(--gold-3) 55%, var(--gold-4) 80%, var(--gold-5));
      color:#111;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .card-head .title{
      display:flex; align-items:center; gap:10px; font-weight:900;
      letter-spacing:.2px;
    }
    .pill{
      display:inline-flex; align-items:center; gap:6px;
      padding:6px 10px; font-size:12.5px; font-weight:800; border-radius:999px;
      color:#111; border:1px solid #b18a37;
      background: linear-gradient(135deg, var(--gold-1), var(--gold-3) 50%, var(--gold-5));
      box-shadow: 0 6px 18px rgba(202,165,82,.35);
    }

    .card-body{
      padding: clamp(16px, 2.5vw, 22px);
      display:grid; grid-template-columns: 1.2fr .8fr; gap: 20px;
    }
    @media (max-width: 860px){
      .card-body{ grid-template-columns: 1fr; }
    }

    /* Sol sütun: açıklama + buton */
    .intro{
      display:grid; align-content:start; gap:14px;
    }
    .intro h2{
      margin:0; font-size: clamp(18px, 2.6vw, 22px);
      letter-spacing:.2px;
    }
    .muted{ color: var(--muted); }

    /* Ödeme özet kutusu */
    .summary{
      border:1px solid var(--ring);
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
      padding: 14px;
      display:grid; gap:10px;
    }
    .row{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .row strong{ font-size: 15px; }
    .sep{ height:1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,.08), transparent); }

    /* Kart ikonları (temsilî) */
    .cards{ display:flex; gap:8px; align-items:center; }
    .cc{
      width:34px; height:22px; border-radius:6px; border:1px solid var(--ring);
      background: linear-gradient(180deg, #111827, #0b1325);
      display:grid; place-items:center; font-size:10px; color:#9ca3af;
    }

    /* İframe alanı */
    .iframeWrap{
      border:1px solid var(--ring);
      background: linear-gradient(180deg, rgba(2,6,23,.6), rgba(2,6,23,.4));
      border-radius: 14px;
      padding: 10px;
      min-height: 120px;
    }
    #paytrIframe iframe{
      width:100%; height: 700px; border:none; border-radius: 10px;
      background:#fff; /* PayTR iFrame’i beyaz zemin üzerinde */
    }

    /* Buton */
    .actions{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; }
    .btn{
      appearance:none; border:0; cursor:pointer; font-weight:900;
      padding: 12px 16px; border-radius: 12px;
      color:#111;
      background: linear-gradient(135deg, var(--gold-1), var(--gold-2) 40%, var(--gold-3) 55%, var(--gold-4) 80%, var(--gold-5));
      border:1px solid #b18a37;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.7), 0 10px 28px rgba(202,165,82,.35);
      transition: transform .06s ease, box-shadow .2s ease;
    }
    .btn:active{ transform: translateY(1px); }

    .hint{ font-size:12.5px; color: var(--muted); }

    /* Küçük not alanı */
    .note{
      margin-top:6px; font-size: 12.5px; color: var(--muted);
    }

    /* Erişilebilir odak */
    :focus-visible{ outline: 3px solid rgba(232,201,114,.65); outline-offset: 2px; border-radius: 10px; }

    /* Light mode desteği (isteğe bağlı) */
    @media (prefers-color-scheme: light){
      :root{ --text:#0b1220; --muted:#475569; --ring: rgba(0,0,0,.08); }
      body{
        color: var(--text);
        background:
          radial-gradient(1200px 600px at 70% -10%, #f1f5f9 0%, transparent 60%),
          radial-gradient(900px 500px at -10% 110%, #e5e7eb 0%, transparent 60%),
          linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
      }
      .card{ background:#fff; }
      .brandbar{ background: linear-gradient(135deg, rgba(0,0,0,.03), rgba(0,0,0,.01)); }
      .muted{ color:#64748b; }
      .iframeWrap{ background:#fff; }
    }
  </style>
</head>
<body>

  <div class="shell">
    <!-- Üst şerit -->
    <div class="brandbar" aria-hidden="true">
      <div class="brandmark">ÜE</div>
      <div class="brandtext">
        <h1>Üreten Eller • Güvenli Ödeme</h1>
        <p class="muted">PayTR korumalı hızlı ve güvenli ödeme.</p>
      </div>
    </div>

    <!-- Kart -->
    <div class="card" role="region" aria-label="Ödeme">
      <div class="card-head">
        <div class="title">
          <!-- Kart simgesi -->
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <rect x="2" y="4" width="20" height="16" rx="3" stroke="#111" stroke-width="1.5"/>
            <rect x="3.5" y="8" width="17" height="2.5" rx="1.2" fill="#111"/>
          </svg>
          <span>Ödeme Bilgileri</span>
        </div>
        <span class="pill">Güvenli • PayTR</span>
      </div>

      <div class="card-body">
        <!-- Sol -->
        <div class="intro">
          <h2>Premium üyeliğinizi güvenle tamamlayın</h2>
          <p class="muted">Kart bilgileriniz PayTR tarafından güvenli iFrame üzerinde işlenir. Bu sayfada kart bilgileri saklanmaz.</p>

          <div class="summary" aria-label="Sipariş Özeti">
            <div class="row"><span>Ürün</span><strong>Premium Üyelik (1 Yıl)</strong></div>
            <div class="row"><span>Tutar</span><strong>₺1.999,00</strong></div>
            <div class="sep"></div>
            <div class="row cards" aria-hidden="true">
              <div class="cc">VISA</div>
              <div class="cc">MC</div>
              <div class="cc">TROY</div>
            </div>
            <p class="note">Taksit seçenekleri bankanıza göre PayTR ekranında görüntülenecektir.</p>
          </div>

          <div class="actions">
            <button id="payNowBtn" class="btn">Ödemeyi Başlat</button>
            <span class="hint">Butona bastığınızda güvenli ödeme iFrame’i aşağıda açılır.</span>
          </div>
        </div>

        <!-- Sağ -->
        <div>
          <div class="iframeWrap">
            <div id="paytrIframe" aria-live="polite">
              <!-- iFrame burada görünecek -->
              <div style="padding:18px; color:var(--muted); text-align:center">
                Güvenli ödeme iFrame’i burada açılacak.
              </div>
            </div>
          </div>
        </div>
      </div> <!-- /card-body -->
    </div> <!-- /card -->
  </div> <!-- /shell -->

  <!-- ⚠️ JS ALANI — DOKUNMAYIN -->
  <script>
    async function startPayment() {
      const user_ip = await fetch("https://api.ipify.org?format=json").then(r => r.json()).then(d => d.ip);
      const body = {
        email: "test@ureteneller.com",      // Kullanıcının e-postası
        payment_amount: 9900,               // 99.00 TL (kuruş cinsinden)
        user_ip: user_ip,
        merchant_oid: "order-" + Date.now(),// Sipariş numarası
        user_name: "Test Kullanıcı",
        user_address: "İstanbul, Türkiye",
        user_phone: "05555555555"
      };

      const response = await fetch("https://us-central1-flutter-ai-playground-38ddf.cloudfunctions.net/getPaytrToken", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });

      const data = await response.json();
      if (data.status === "success") {
        document.getElementById("paytrIframe").innerHTML = `
          <iframe src="https://www.paytr.com/odeme/guvenli/${data.token}"></iframe>
        `;
      } else {
        alert("Ödeme başlatılamadı: " + (data.reason || "Bilinmeyen hata"));
      }
    }

    document.getElementById("payNowBtn").addEventListener("click", startPayment);
  </script>
</body>
</html>
