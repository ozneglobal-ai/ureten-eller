<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Üreten Eller • Ana Sayfa</title>
  <meta name="description" content="Üreten Eller: El emeği ürünler, yöresel lezzetler ve daha fazlası. Kategorilere göz atın, arayın, ilan verin." />
  <link rel="icon" href="/assets/icons/favicon.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <style>
    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#fff;color:#0b1220;-webkit-font-smoothing:antialiased}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}

    .page{min-height:100%;display:grid;grid-template-rows:auto 1fr auto}
    .topbar{position:sticky;top:0;z-index:40;backdrop-filter:saturate(140%) blur(8px);background:rgba(255,255,255,.8);border-bottom:1px solid #e5e7eb}
    .topbar-inner{max-width:1200px;margin:0 auto;padding:14px 16px;display:flex;gap:12px;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px}
    .brand .logo{width:36px;height:36px;border-radius:10px;background:#000 url('/assets/icons/favicon.png') center/cover no-repeat;box-shadow:inset 0 0 0 1px rgba(255,255,255,.08)}
    .brand h1{font-size:18px;letter-spacing:.2px;margin:0;font-weight:800}
    .actions{display:flex;align-items:center;gap:8px}

    /* Üst kategori çipleri */
    .catnav .chip{border:1px solid #e5e7eb;border-radius:999px;padding:8px 12px;background:#fff;font-weight:700;cursor:pointer}
    .catnav .chip:hover{background:#fafafa}
    .catnav .chip.active{color:#111;background:radial-gradient(120% 120% at 0% 0%, rgba(255,255,255,.75), transparent 35%),linear-gradient(180deg, #f7e7b5, #e8c972 40%, #d7b45d 55%, #caa552 80%, #b79343);border:1px solid #b18a37;box-shadow:inset 0 1px 0 rgba(255,255,255,.7), 0 4px 14px rgba(202,165,82,.3)}
    .catdrops .panel{display:none;border:1px solid #e5e7eb;border-radius:12px;padding:10px;margin:8px 16px;background:#fff}
    .catdrops .panel.open{display:block}

    /* Hero */
    .hero{position:relative;border:1px solid #e5e7eb;border-radius:20px;padding:22px 18px;display:block;gap:20px;overflow:hidden;margin:16px auto;max-width:1200px}
    .hero::after{content:"";position:absolute;inset:-60% -40% auto auto;aspect-ratio:1/1;background:radial-gradient(closest-side,rgba(255,215,0,.15),transparent 70%)}
    .hero h2{font-size:28px;margin:0 0 10px 0;letter-spacing:.2px}
    .hero p{margin:0 0 16px 0;color:#4b5563}
    .cta-row{display:flex;flex-wrap:wrap;gap:8px}

    /* Buttons */
    .btn{--gold:#caa552;--shine:rgba(255,255,255,.7);--ink:#0b1220;appearance:none;border:0;cursor:pointer;font-weight:800;border-radius:12px;padding:10px 14px;position:relative;isolation:isolate;transition:transform .06s ease, box-shadow .2s ease;user-select:none}
    .btn:active{transform:translateY(1px)}
    .btn.gold{color:#111;background:radial-gradient(120% 120% at 0% 0%, rgba(255,255,255,.75), transparent 35%),linear-gradient(180deg, #f7e7b5, #e8c972 40%, #d7b45d 55%, #caa552 80%, #b79343);border:1px solid #b18a37;box-shadow:inset 0 1px 0 var(--shine), 0 4px 18px rgba(202,165,82,.35)}
    .btn.ghost{background:#fff;border:1px solid #e5e7eb}

    /* Auth badge */
    .auth-badge{display:flex;align-items:center;gap:10px;padding:6px 10px;border:1px solid #e5e7eb;border-radius:999px}
    .avatar{width:28px;height:28px;border-radius:50%;background:#f3f4f6;overflow:hidden}

    /* Modal */
    dialog.modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.32);z-index:60;padding:16px}
    dialog[open].modal{display:grid}
    .sheet{width:min(560px,96vw);background:#fff;border-radius:18px;border:1px solid #e5e7eb;box-shadow:0 30px 60px rgba(0,0,0,.15);overflow:hidden}
    .sheet header{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid #eee}
    .sheet header h3{margin:0;font-size:18px}
    .sheet .inner{padding:16px}
    .form{display:grid;gap:10px}
    .row2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:560px){.row2{grid-template-columns:1fr}}
    .input{display:flex;flex-direction:column;gap:6px}
    .input label{font-size:12px;color:#6b7280}
    .input input, .input select{border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px;font-size:14px}
    .pw{position:relative}
    .pw input{padding-right:38px}
    .pw .toggle{position:absolute;right:8px;top:50%;transform:translateY(-50%);border:0;background:transparent;cursor:pointer}

    /* Footer */
    .legal{background:#000;color:#fff}
    .legal .inner{max-width:1200px;margin:0 auto;padding:16px}
    .legal .row{display:flex;justify-content:space-between;align-items:center;gap:12px}
    .legal .links{display:flex;flex-wrap:wrap;gap:14px;align-items:center}
  </style>
</head>
<body>
  <div class="page">
    <div class="topbar">
      <div class="topbar-inner">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <h1>Üreten Eller</h1>
        </div>
        <div class="actions">
          <button class="btn gold" id="postBtn">İlan Ver</button>
          <div id="authArea" class="auth-badge" style="display:none">
            <div class="avatar"><img id="uAvatar" alt="" /></div>
            <div id="uName" class="hint">Kullanıcı</div>
            <button class="btn ghost" id="signOutBtn">Çıkış</button>
          </div>
          <button class="btn ghost" id="signInBtn">Giriş / Kayıt</button>
        </div>
      </div>

      <!-- Üstte Yatay Kategori Şeritleri -->
      <nav id="catNav" class="catnav" aria-label="Kategoriler" style="border-top:1px solid #eee;border-bottom:1px solid #eee;background:#fff">
        <div class="catnav-inner" style="max-width:1200px;margin:0 auto;padding:8px 16px;display:flex;gap:8px;flex-wrap:wrap"></div>
      </nav>
      <div id="catDrops" class="catdrops" style="background:#fff">
        <div class="catdrops-inner" style="max-width:1200px;margin:0 auto;padding:0 16px 8px"></div>
      </div>
    </div>

    <main>
      <section class="content">
        <div class="hero">
          <h2>El emeği & yerel lezzetler tek çatı altında</h2>
          <p>Üreten kadınlardan, ev yapımı lezzetlerden, el işi tasarımlardan alışveriş yapın. Konumunuza göre arayın, kategorilerden keşfedin.</p>
          <div class="cta-row">
            <button class="btn gold" id="browseBtn">Kategorileri Keşfet</button>
          </div>
        </div>
      </section>
    </main>

    <footer class="legal">
      <div class="inner">
        <div class="row">
          <div class="links">
            <a href="/legal/kullanim-sartlari.html">Kullanım Şartları</a>
            <a href="/legal/gizlilik-politikasi.html">Gizlilik Politikası</a>
            <a href="/legal/kvkk-aydinlatma.html">KVKK Aydınlatma</a>
            <a href="/legal/topluluk-kurallari.html">Topluluk Kuralları</a>
            <a href="/legal/yasakli-urunler.html">Yasaklı Ürünler</a>
            <a href="/legal/mesafeli-satis-sozlesmesi.html">Mesafeli Satış</a>
            <a href="/legal/on-bilgilendirme-formu.html">Ön Bilgilendirme</a>
            <a href="/legal/teslimat-iade-iptal.html">Teslimat/İade</a>
            <a href="/iletisim-impressum.html">İletişim</a>
          </div>
          <div class="hint">© <span id="y"></span> Üreten Eller</div>
        </div>
      </div>
    </footer>
  </div>

  <!-- ===== Auth Modal ===== -->
  <dialog class="modal" id="authModal">
    <div class="sheet">
      <header>
        <h3>Giriş Yap / Kayıt Ol</h3>
        <button class="btn ghost" data-close>✕</button>
      </header>
      <div class="inner">
        <div class="form" style="margin-bottom:16px">
          <div class="input"><label>E‑posta</label><input id="li_email" type="email" placeholder="ornek@mail.com" autocomplete="username"/></div>
          <div class="input pw"><label>Şifre</label><input id="li_pass" type="password" placeholder="••••••••" autocomplete="current-password"/><button class="toggle" data-toggle="li_pass" aria-label="Şifreyi göster">👁️</button></div>
          <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap">
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn gold" id="loginBtn">Giriş Yap</button>
              <button class="btn ghost" id="forgotBtn" type="button">Şifremi Unuttum</button>
            </div>
            <button class="btn gold" id="googleBtn" type="button" aria-label="Google ile Giriş">Google ile Giriş</button>
          </div>
        </div>
        <hr style="border:0;border-top:1px solid #eee;margin:8px 0 14px">
        <details>
          <summary style="cursor:pointer;font-weight:700">Hesabın yok mu? Kayıt ol</summary>
          <div class="form" style="margin-top:10px">
            <div class="row2">
              <div class="input"><label>Kullanıcı Adı</label><input id="su_username" maxlength="24" placeholder="@kullanici"/></div>
              <div class="input"><label>Ad Soyad</label><input id="su_name" placeholder="Adınız Soyadınız"/></div>
            </div>
            <div class="row2">
              <div class="input"><label>İl</label>
                <select id="su_province"></select>
              </div>
              <div class="input"><label>İlçe</label><input id="su_district" placeholder="İlçeniz"/></div>
            </div>
            <div class="row2">
              <div class="input"><label>E‑posta</label><input id="su_email" type="email" placeholder="ornek@mail.com" autocomplete="email"/></div>
              <div class="input pw"><label>Şifre</label><input id="su_pass" type="password" placeholder="En az 6 karakter" autocomplete="new-password"/><button class="toggle" data-toggle="su_pass" aria-label="Şifreyi göster">👁️</button></div>
            </div>
            <div class="input pw"><label>Şifre (Tekrar)</label><input id="su_pass2" type="password" placeholder="Şifreyi tekrar yazın" autocomplete="new-password"/><button class="toggle" data-toggle="su_pass2" aria-label="Şifreyi göster">👁️</button></div>
            <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
              <button class="btn gold" id="registerBtn">Kayıt Ol</button>
              <div class="hint">Kayıtla birlikte <strong>mail doğrulama</strong> gönderilir. Gelen kutusu ve <strong>SPAM</strong> klasörünü kontrol edin.</div>
            </div>
          </div>
        </details>
      </div>
    </div>
  </dialog>

  <!-- Firebase init (kökten) -->
  <script type="module" src="/firebase-init.js"></script>

  <script type="module">
    import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, signInWithPopup, GoogleAuthProvider, createUserWithEmailAndPassword, sendEmailVerification, updateProfile, sendPasswordResetEmail, signOut } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js';

    // Yıl
    document.getElementById('y').textContent = new Date().getFullYear();

    // TR İller
    const PROVINCES = ["Adana","Adıyaman","Afyonkarahisar","Ağrı","Aksaray","Amasya","Ankara","Antalya","Ardahan","Artvin","Aydın","Balıkesir","Bartın","Batman","Bayburt","Bilecik","Bingöl","Bitlis","Bolu","Burdur","Bursa","Çanakkale","Çankırı","Çorum","Denizli","Diyarbakır","Düzce","Edirne","Elazığ","Erzincan","Erzurum","Eskişehir","Gaziantep","Giresun","Gümüşhane","Hakkari","Hatay","Iğdır","Isparta","İstanbul","İzmir","Kahramanmaraş","Karabük","Karaman","Kars","Kastamonu","Kayseri","Kırıkkale","Kırklareli","Kırşehir","Kilis","Kocaeli","Konya","Kütahya","Malatya","Manisa","Mardin","Mersin","Muğla","Muş","Nevşehir","Niğde","Ordu","Osmaniye","Rize","Sakarya","Samsun","Siirt","Sinop","Sivas","Şanlıurfa","Şırnak","Tekirdağ","Tokat","Trabzon","Tunceli","Uşak","Van","Yalova","Yozgat","Zonguldak"].sort((a,b)=>a.localeCompare(b,'tr'));
    const suProv = document.getElementById('su_province');
    if (suProv){ suProv.innerHTML = '<option value="" disabled selected>İl seçiniz</option>' + PROVINCES.map(p=>`<option value="${p}">${p}</option>`).join(''); }

    // Kategoriler
    const CATS = [
      {id:'yemek', title:'🍲 Yemekler', subs:[["evyemek","Ev yemekleri"],["borek","Börek-çörek"],["corba","Çorba"],["zeytiny","Zeytinyağlı"],["pilav","Pilav-makarna"],["et","Et-tavuk"],["kahvalti","Kahvaltılık"],["meze","Meze"],["dondur","Dondurulmuş"],["cocuk","Çocuk öğünleri"],["diyetvegf","Diyet/vegan/gf"]]},
      {id:'pasta', title:'🎂 Pasta & Tatlı', subs:[["yaspasta","Yaş pasta"],["kek","Kek-cupcake"],["kurabiye","Kurabiye"],["serbetli","Şerbetli"],["sutlu","Sütlü"],["cheese","Cheesecake"],["diyettat","Diyet tatlı"],["cikolata","Çikolata/şekerleme"],["dogumset","Doğum günü setleri"]]},
      {id:'sos', title:'🫙 Reçel • Turşu • Sos', subs:[["recel","Reçel-marmelat"],["pekmez","Pekmez"],["tursu","Turşu"],["dom","Domates/biber sos"],["acios","Acı sos"],["salca","Salça"],["sirke","Sirke"],["konserve","Konserve"]]},
      {id:'yoresel', title:'🌾 Yöresel / Kışlık', subs:[["eriste","Erişte"],["tarhana","Tarhana"],["yufka","Yufka"],["manti","Mantı"],["kurut","Kurutulmuş"],["salca2","Salça"],["sirke2","Sirke"],["konserve2","Konserve"]]},
      {id:'diet', title:'🥗 Diyet / Vegan / GF', subs:[["fit","Fit tabaklar"],["vegan","Vegan yemekler"],["gf","GF unlu mamuller"],["sekersiz","Şekersiz tatlı"],["keto","Keto ürün"],["protein","Protein atıştırmalık"]]},
      {id:'taki', title:'💍 Takı', subs:[["bileklik","Bileklik"],["kolye","Kolye"],["kupe","Küpe"],["yuzuk","Yüzük"],["halhal","Halhal"],["bros","Broş"],["set","Setler"],["isimli","Kişiye özel"],["makrome","Makrome"],["dogaltas","Doğal taş"],["recine","Reçine"],["telsarma","Tel sarma"]]},
      {id:'bebek', title:'👶 Bebek & Çocuk', subs:[["fig","Figürler"],["cingirak","Çıngırak"],["dis","Diş kaşıyıcı"],["bezoy","Bez oyuncak/kitap"],["montessori","Montessori"],["set2","Setler"],["patik","Patik-bere"],["battaniye","Battaniye"],["onluk","Önlük"],["lohusa","Lohusa seti"],["sac","Saç aksesuarı"],["giyim","El emeği kıyafet"]]},
      {id:'orgu', title:'🧶 Örgü / Triko', subs:[["hirka","Hırka"],["kazak","Kazak"],["atkibere","Atkı-bere"],["panco","Panço"],["sal","Şal"],["corap","Çorap"],["lif","Lif takımı"],["bebektk","Bebek takımı"],["yelek","Yelek"],["kirlen","Kırlent-örtü"],["igneoyasi","İğne oyası"]]},
      {id:'terzi', title:'✂️ Dikiş / Terzilik', subs:[["paca","Paça/onarım"],["fermuar","Fermuar değişimi"],["perde","Perde"],["nevresim","Nevresim"],["masa","Masa örtüsü"],["ozel","Özel dikim"],["kostum","Kostüm"]]},
      {id:'makrome', title:'🧵 Makrome & Dekor', subs:[["duvar","Duvar süsü"],["saksi","Saksı askısı"],["anahtar","Anahtarlık"],["avize","Avize"],["runner","Runner"],["sepet","Sepet"],["raf","Raf/dekor"]]},
      {id:'evdekor', title:'🏠 Ev Dekor & Aksesuar', subs:[["kece","Keçe işleri"],["kirlent","Kırlent"],["kapi","Kapı süsü"],["tepsi","Tepsi süs"],["cerceve","Çerçeve"],["ruya","Rüya kapanı"],["tablo","Tablo"]]},
      {id:'mum', title:'🕯️ Mum & Kokulu', subs:[["soya","Soya/balmumu"],["tas","Kokulu taş"],["sprey","Oda spreyi"],["tutsu","Tütsü"],["jel","Jel mum"],["hediye","Hediye seti"]]},
      {id:'kozmetik', title:'🧼 Doğal Sabun & Kozmetik', subs:[["zeytin","Zeytinyağlı sabun"],["bitkisel","Bitkisel sabun"],["sampuan","Katı şampuan"],["balm","Dudak balmı"],["krem","Krem/merhem"],["banyotuzu","Banyo tuzu"],["lavanta","Lavanta kesesi"]]},
      {id:'amigurumi', title:'🧸 Amigurumi & Oyuncak', subs:[["anahtar2","Anahtarlık"],["magnet","Magnet"],["kolek","Koleksiyon"],["dekorbebek","Dekor bebek"]]},
    ];

    const catBar = document.querySelector('#catNav .catnav-inner');
    const drops = document.querySelector('#catDrops .catdrops-inner');

    function buildTopCats(){
      catBar.innerHTML = '';
      drops.innerHTML = '';
      CATS.forEach((cat)=>{
        const chip = document.createElement('button');
        chip.className = 'chip';
        chip.type = 'button';
        chip.textContent = cat.title;
        chip.dataset.target = `p_${cat.id}`;

        const panel = document.createElement('div');
        panel.className = 'panel';
        panel.id = `p_${cat.id}`;
        panel.innerHTML = cat.subs.map(([id,label])=>`<a href="#" data-open-auth style="display:block;padding:8px 6px;border-radius:8px">${label}</a>`).join('');
        panel.addEventListener('click',(e)=>{ if(e.target.matches('a[data-open-auth]')){ e.preventDefault(); authModal.showModal(); }});

        chip.addEventListener('click',()=>{
          const wasOpen = panel.classList.contains('open');
          // Kapat tüm paneller ve aktif chipleri
          document.querySelectorAll('.catdrops .panel.open').forEach(p=>p.classList.remove('open'));
          document.querySelectorAll('#catNav .chip.active').forEach(c=>c.classList.remove('active'));
          if (!wasOpen){
            panel.classList.add('open');
            chip.classList.add('active');
          }
        });

        catBar.appendChild(chip);
        drops.appendChild(panel);
      });
    }
    buildTopCats();

    // Auth Modal helpers
    const authModal = document.getElementById('authModal');
    document.querySelectorAll('#authModal [data-close]').forEach(b=>b.addEventListener('click',()=>authModal.close()));
    document.getElementById('signInBtn')?.addEventListener('click',()=>authModal.showModal());

    // Password visibility toggles
    document.querySelectorAll('.toggle').forEach(b=>b.addEventListener('click',()=>{
      const id = b.getAttribute('data-toggle'); const inp = document.getElementById(id);
      if (inp) inp.type = inp.type === 'password' ? 'text' : 'password';
    }));

    // Firebase Auth
    const auth = getAuth();
    const provider = new GoogleAuthProvider();

    document.getElementById('googleBtn')?.addEventListener('click', async ()=>{
      try{ await signInWithPopup(auth, provider); authModal.close(); }
      catch(err){ alert('Google ile giriş başarısız: '+(err?.message||err)); }
    });

    document.getElementById('loginBtn')?.addEventListener('click', async ()=>{
      const email = document.getElementById('li_email').value.trim();
      const pass = document.getElementById('li_pass').value;
      if(!email || pass.length<6){ alert('E‑posta ve şifreyi kontrol edin.'); return; }
      try{ await signInWithEmailAndPassword(auth, email, pass); authModal.close(); }
      catch(err){ alert('Giriş başarısız: '+(err?.message||err)); }
    });

    document.getElementById('forgotBtn')?.addEventListener('click', async ()=>{
      const email = document.getElementById('li_email').value.trim();
      if(!email){ alert('Şifre sıfırlamak için e‑posta girin.'); return; }
      try{ await sendPasswordResetEmail(auth, email); alert('Şifre sıfırlama e‑postası gönderildi. Gelen kutusu ve SPAM klasörünü kontrol edin.'); }
      catch(err){ alert('İşlem başarısız: '+(err?.message||err)); }
    });

    document.getElementById('registerBtn')?.addEventListener('click', async ()=>{
      const username = document.getElementById('su_username').value.trim();
      const name = document.getElementById('su_name').value.trim();
      const province = document.getElementById('su_province').value;
      const district = document.getElementById('su_district').value.trim();
      const email = document.getElementById('su_email').value.trim();
      const pass = document.getElementById('su_pass').value;
      const pass2 = document.getElementById('su_pass2').value;
      if(!username || !name || !province || !district || !email || pass.length<6 || pass!==pass2){ alert('Lütfen tüm alanları doğru doldurun.'); return; }
      try{
        const cred = await createUserWithEmailAndPassword(auth, email, pass);
        await updateProfile(cred.user, { displayName: name });
        try{ await sendEmailVerification(cred.user); }catch{}
        alert('Kayıt tamamlandı. Doğrulama e‑postası gönderildi. SPAM klasörünü de kontrol edin.');
        authModal.close();
      }catch(err){ alert('Kayıt başarısız: '+(err?.message||err)); }
    });

    onAuthStateChanged(auth, (u)=>{
      const authArea = document.getElementById('authArea');
      const signBtn = document.getElementById('signInBtn');
      if (u){
        authArea.style.display='flex'; signBtn.style.display='none';
        document.getElementById('uName').textContent = u.displayName || u.email || 'Kullanıcı';
        document.getElementById('uAvatar').src = u.photoURL || '/assets/img/avatar-default.png';
      } else {
        authArea.style.display='none'; signBtn.style.display='inline-flex';
      }
    });

    document.getElementById('signOutBtn')?.addEventListener('click', async ()=>{ try{ await signOut(auth); }catch{} });

    // CTA
    // İSTEK: "Kategorileri Keşfet" VE "İlan Ver" butonlarına basınca giriş paneli açılsın.
    document.getElementById('browseBtn')?.addEventListener('click', ()=>{ authModal.showModal(); });

    // İlan ver -> Giriş paneli aç (zaten vardı)
    document.getElementById('postBtn')?.addEventListener('click', ()=>{ authModal.showModal(); });
  </script>
</body>
</html>
